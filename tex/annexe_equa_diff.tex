%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Équations différentielles à coefficients 
         constants\label{annexe-eqndiff}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chaptermark{Équations différentielles}
La forme générale d'une équation différentielle à coefficients constants est 
donnée par :
%-------------------------------------------------------------------------------
\begin{align}
\sum_{i=0}^{n}a_i\devi{s(t)}{i}=\sum_{i=0}^{m}b_i\devi{e(t)}{i}
\end{align}
%-------------------------------------------------------------------------------
avec $a_i$ et $b_i$ des coefficients réels et $m$ et $n$ des entiers naturels 
tels que $m\le n$. L'ordre de l'équation est donnée par $n$.

Nous allons dans cette annexe, présenter la résolution direct 
des formes canoniques du premier et du second ordre. La méthodologie consiste
à déterminer la solution générale de l'équation homogène (c.a.d sans second 
membre) puis de chercher une solution particulière pour l'équation avec second 
membre. Nous nous limiterons à l'étude des solutions pour des seconds membres 
correspondant à l'échelon-unité en entrée.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section[Premier ordre]{Résolution équation différentielle du premier ordre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Forme canonique}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La forme générale d'une équation différentielle du premier ordre est
donnée par : 
\[
a_1\devi{s(t)}{}+a_0s(t)=b_0e(t)
\]
Il est toujours possible de simplifier une telle équation sous la forme :
\[
\devi{s(t)}{}+\dfrac{a_0}{a_1}s(t)=\dfrac{b_0}{a_1}e(t)
\]
La forme canonique d'une équation différentielle du premier ordre est alors :
%-------------------------------------------------------------------------------
\begin{bequation}[ams align]
\devi{s(t)}{}+as(t)=be(t)
\end{bequation}
%-------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sans second membre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La solution générale de l'équation sans second membre est de la forme :
\[
s(t) = C e^{-\frac{a_0}{a_1}t}\,\,\,\,\text{avec}\,\,\,\,C\in\mathbb{R}
\]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Avec second membre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Considèrons l'équation différentielle suivante régissant l'entrée
et la sortie d'un~\gls{slci} :
\[
\devi{s(t)}{}+as(t)=be(t)
\]
avec pour condition initiale $s(0)=s_0$.

La réponse libre du système $s_1(t)$ satisfait l'équation différentielle
\[
\devi{s_1(t)}{}=-as_1(t)
\]
Cette réponse ne dépend que des conditions initiales, ici $s(0)=s_0$.
Cette solution est donc de la forme :
\[
s_1(t)=Ce^{-at}
\]
avec $C$ une constante réel. La réponse doit satisfaire la condition 
initiale $s(0)=s_0$. Ce qui impose :
\[
s_1(t)=s_0e^{-at}
\]
La réponse indicielle est donnée pour $e(t)=u(t)$. Pour $t\geq0$, l'équation 
différentielle avec second membre est alors :
\[
\devi{s(t)}{}+as(t)=b
\]
Déterminons une solution particulière $s_2(t)$ de cette équation 
différentielle de la forme :
\[
s_2(t)=\lambda(t)e^{-at}.
\]
En introduisant, celle-ci dans l'équation différentielle on a alors :
\[
\lambda'(t)e^{-at}-a\lambda(t)e^{-at}+a\lambda(t)e^{-at}=b
\]
On cherche une primitive de la dérivée de $\lambda$ à partir de :
\[
\lambda'(t)=be^{at}
\]
soit alors :
\[
\lambda(t)=\dfrac{b}{a}e^{at}+C
\]
avec $C$ une constante d'intégration.
\[
s_2(t)=\dfrac{b}{a}+Ce^{-at}.
\]
La solution générale est donnée par la somme des deux réponses précédentes :
%-------------------------------------------------------------------------------
\begin{align*}
    s(t)&=s_1(t)+s_2(t)\\
    s(t)&=s_0e^{-at}+\dfrac{b}{a}+Ce^{-at}
\end{align*}
%-------------------------------------------------------------------------------
La constante $C$ se détermine à partir de la condition initiale:
\[
s(t)=s_0e^{-at}+\dfrac{b}{a}\left(1-e^{-at}\right)
\]

Prenons l'équation différentielle telle que $a=0.5$ et $b=0.25$. Il est
possible de déterminer toutes les solutions pour différentes valeurs de
la condition initiale, comme représenté par la figure ci-dessous.
Le graphe de la solution en rouge correspond à la solution
pour une condition initiale nulle.
%-------------------------------------------------------------------------------
\begin{center}
    \tikzsetnextfilename{solutions_equadiff-annexe_equa_diff-ext}
    \input{tikz/solutions_equadiff-annexe_equa_diff.tex}
\end{center}
%-------------------------------------------------------------------------------
Sur les trois termes de la solution générale, un seul est non
nul pour $t\to\infty$ (si $a>0$). Il correspond au régime permanent de la 
réponse. Les deux autres correspondent au régime transitoire.
%-------------------------------------------------------------------------------
\begin{align*}
    s(t)=\textcolor{col2}{s_0e^{-at}-\dfrac{b}{a}e^{-at}}&+
    \textcolor{col6}{\dfrac{b}{a}}\\
    \textcolor{col2}{transitoire} &\quad\textcolor{col6}{permanent}
\end{align*}
%-------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section[Second ordre]{Résolution équation différentielle du second ordre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La forme générale d'une équation différentielle du second ordre est
donnée par : 
%-------------------------------------------------------------------------------
\begin{bequation}[ams align]
    a\devi{s(t)}{2}+b\devi{s(t)}{}+cs(t)=d\cdot e(t)
\end{bequation}
%-------------------------------------------------------------------------------
avec pour conditions initialles $s(0)=s_0$ et $s'(0)=s_1$.

La solution générale est de la forme 
\[
    s(t)=s_P+s_H
\]
où $s_P=\dfrac{d}{c}$ est une solution particulière et la solution homogène 
telle que $s_H=\lambda_1 e^{r_1 t}+
\lambda_2 e^{r_2 t}$ avec $r_1$ et $r_2$ les racines du polynôme 
caractéristique composé des coefficients de l'équation différentielle 
($aX^2+bX+c=0$).
La solution générale s'écrit alors,
\[
    s(t)=\dfrac{d}{c}+\lambda_1 e^{r_1 t}+\lambda_2 e^{r_2 t}
\]
où $\lambda_1$ et $\lambda_2$ dépendent des conditions initiales. 

On écrit :
\[
    \lambda_1=\dfrac{-r_2(s_0-s_P)+s_1}{r_1-r_2}
\]
\[
    \lambda_2=\dfrac{r_1(s_0-s_P)-s_1}{r_1-r_2}
\]
Ci dessous nous avons tracé les solutions pour différentes conditions initiales
$s_0$ et $s_1=\{-10,-5,5,10\}$ pour l'équation différentielle telle que
$a=1,b=3,c=1,d=1.5$.
%-------------------------------------------------------------------------------
\begin{center}
    \tikzsetnextfilename{solutions_equadiff_2nd-s1-m10-annexe_equa_diff-ext}
    \input{tikz/solutions_equadiff_2nd_s1-m10-annexe_equa_diff.tex}
    \tikzsetnextfilename{solutions_equadiff_2nd-s1-m5-annexe_equa_diff-ext}
    \input{tikz/solutions_equadiff_2nd_s1-m5-annexe_equa_diff.tex}
    
    \tikzsetnextfilename{solutions_equadiff_2nd-s1-5-annexe_equa_diff-ext}
    \input{tikz/solutions_equadiff_2nd_s1-5-annexe_equa_diff.tex}
    \tikzsetnextfilename{solutions_equadiff_2nd-s1-10-annexe_equa_diff-ext}
    \input{tikz/solutions_equadiff_2nd_s1-10-annexe_equa_diff.tex}
\end{center}
%-------------------------------------------------------------------------------
Constatons que les exponentielles de la solution générale ne s'annulent que si
$r_1$ et $r_2$ sont à partie rélles négatives (ce qui correspond aux pôles de
la fonction de transfert). On peut alors identifier les termes responsables
du régime transitoire et permanent.
%-------------------------------------------------------------------------------
\begin{align*}
    s(t)=\textcolor{col2}{\lambda_1 e^{r_1 t}+\lambda_2 e^{r_2 t}}&+
    \textcolor{col6}{\dfrac{d}{c}}\\
    \textcolor{col2}{transitoire} &\quad\textcolor{col6}{permanent}
\end{align*}
%-------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%annexe_equa_diff.tex
