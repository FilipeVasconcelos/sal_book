%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter[Schéma fonctionnels]
        {Schémas fonctionnels et graphes de fluence
        \label{chap-schemabloc}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\minitoc
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Dans ce chapitre, nous allons introduire un outil graphique pour faciliter 
la représentation des relations mathématiques entre les différents 
éléments constituants un \gls{slci}. Cet outil est le 
\textbf{schéma fonctionnel} ou également appelé \textbf{schéma-bloc}. Les 
schémas fonctionnels nous seront très utiles pour l'étude des systèmes 
asservis. Nous introduirons une algèbre de blocs permettant de réduire les 
schémas-blocs qui nous permettront de s'affranchir de la manipulation
d'expression mathématique de grande taille. Nous aborderons également le cas 
des entrées multiples. 

Dans une dernière partie nous introduirons 
les graphes de fluence, comme présenté dans~\cite{Ostertag}. Ces derniers 
sont moins utilisés pour l'étude des \gls{slci}, et peuvent donc être négligés 
dans une première lecture, l'algèbre qui lui est associée s'avère cependant 
bien plus éfficace et pourra être utilisée dans d'autres 
applications (ex : éléctronique, réseaux de neurones).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\'Eléments de base des schémas fonctionnels}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Les schémas fonctionnels sont composés de quatre éléments de base:
\textbf{les flèches, les blocs, les comparateurs et sommateurs et les points 
de prélèvement}
%\begin{itemize}
%    \item les flèches.
%    \item les blocs.
%    \item les comparateurs et sommateurs.
%    \item les points de prélèvement.
%\end{itemize}

%\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Flèche}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Les flèches donnent la direction de l'information (i.e du signal) au sein du 
schéma-blocs. Elles peuvent être ornées de la grandeur mathématique qui leurs 
sont associée. 
Celles-ci peuvent être des grandeurs temporelles ou dans le domaine de Laplace. 
\begin{center}
\tikzsetnextfilename{sb_fleche-chap_bloc-ext}
\input{tikz/sb_fleche-chap_bloc.tex}
\end{center}
Cependant, nous nous limiterons à l'usage de ces schémas fonctionnelles pour la 
représentation de grandeur dans le domaine de Laplace.

Pour alléger la notation dans ce chapitre, nous omettrons 
très souvent la variable $p$ des grandeurs dans le domaine de Laplace désignées 
par une majuscule.

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Bloc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Le bloc est la représentation d'une fonction de transfert entre deux 
grandeurs dans le domaine de Laplace. Par exemple, la relation entre l'entrée 
$E$ et la sortie $S$ définit par la fonction de transfert $H$ qui s'écrit 
formellement, 
\begin{bequation}[ams align]
S = HE,\label{eq-ES}
\end{bequation}
est équivalente au schéma fonctionnel\footnote{Les schémas-blocs de ce document
ont tous étaient réalisés avec les macros Ti\emph{k}Z (\verb?schemabloc?) 
écrit par R. Papanicola\cite{schemabloc}. \`A noter que des macros 
Ti\emph{k}Z (\verb?gfluence?) pour représenter les graphes de fluence 
de ce même chapitre, ont était fortement inspiré par ce même auteur.} 
suivant:

\begin{center}
\tikzsetnextfilename{sb_bloc-chap_bloc-ext}
\input{tikz/sb_bloc-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Comparateur/Sommateur :}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Les comparateurs ou sommateurs permettent de représenter des opérations 
simples entre différentes grandeurs.
Nous parlerons respectivement de comparateur ou de sommateur dans le cas 
d'une différence ou d'une somme entre deux grandeurs. 


Par exemple, la relation 
$$
S = E_1-E_2 
$$
est équivalente au comparateur suivant :
\begin{center}
\tikzsetnextfilename{sb_comp-chap_bloc-ext}
\input{tikz/sb_comp-chap_bloc.tex}
\end{center}

De même la somme de deux grandeurs,
$$
S = E_1+E_2
$$
est équivalente au sommateur suivant :
\begin{center}
\tikzsetnextfilename{sb_somm-chap_bloc-ext}
\input{tikz/sb_somm-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Point de prélèvement}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Un point de prélèvement (ou point de dérivation ou encore jonction) 
est un point d'une flèche où une information est prélevée ne modifiant pas 
sa valeur. Par exemple, la jonction suivante (représentée par un point) donne 
lieu à deux branches auxquelles sont associées la même grandeur $S$.

\begin{center}
\tikzsetnextfilename{sb_point-chap_bloc-ext}
\input{tikz/sb_point-chap_bloc.tex}
\end{center}

Dans cette configuration, la branche 1 est dite \og direct\fg et la 
branche 2 est dite de \og retour\fg.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Transformation des schémas fonctionnels}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Réduction de schéma-bloc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Blocs en série / produit}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Lorsque les blocs sont placés en série, la fonction de transfert 
entre la sortie et l'entrée globale est le produit des fonctions de 
transfert mis en jeu. Par exemple, les deux schémas fonctionnels suivants 
sont équivalents.

\begin{center}
\tikzsetnextfilename{sb_reduc_serie_1-chap_bloc-ext}
\input{tikz/sb_reduc_serie_1-chap_bloc.tex}
\end{center}

\begin{center}
\tikzsetnextfilename{sb_reduc_serie_2-chap_bloc-ext}
\input{tikz/sb_reduc_serie_2-chap_bloc.tex}
\end{center}

Nous laissons au lecteur la démonstration triviale à partir des relations 
mathématiques.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Blocs en parallèle} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Lorsque les blocs sont placés en parallèle, la fonction de transfert 
entre la sortie et l'entrée globale est la somme des fonctions de transfert 
mis en jeu. Par exemple, les deux schémas fonctionnels suivants 
sont équivalents.

\begin{center}
    \tikzsetnextfilename{sb_reduc_para_1-chap_bloc-ext}
    \input{tikz/sb_reduc_para_1-chap_bloc.tex}
\end{center}

\begin{center}
    \tikzsetnextfilename{sb_reduc_para_2-chap_bloc-ext}
    \input{tikz/sb_reduc_para_2-chap_bloc.tex}
\end{center}

La démonstration est également triviale.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{La boucle de contre-réaction (positive ou négative)
          \label{sec-boucle}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

La boucle de contre-réaction\footnote{\og Positive or negative feedback\fg, 
chez nos collègues anglophones.} peut être réduite à une simple fonction 
de transfert. Considérons un système définit par le schéma-bloc ci-dessous, 
composé des différents élements de bases.

\begin{center}
    \tikzsetnextfilename{boucle-chap_bloc-ext}
    \input{tikz/boucle-chap_bloc.tex}
\end{center}
Notons l'utilisation du symbole $\pm$ pour envisager à la fois les 
comparateurs et sommateurs.

Déterminons la relation entre l'entrée $E$ et la sortie $S$ de ce système.
Pour celà réécrivons les relations linéaires simples issus de ce schéma-bloc.
On sait que :
\begin{align}
    \epsilon&=E\pm M \label{eq-fb.1}\\
    M&=H_2S       \label{eq-fb.2}\\
    S&=H_1\epsilon \label{eq-fb.3}
\end{align}
Introduisons l'\cref{eq-fb.2} dans~(\ref{eq-fb.1}) et le résulat ainsi 
obtenu dans~(\ref{eq-fb.3}):
\begin{align*}
    \epsilon&=E\pm H_2S \\
     S&=H_1\big(E\pm H_2S\big) \\
     S&=H_1E\pm H_1H_2S
\end{align*}
Regroupons les termes dépendant de la sortie ensemble pour déterminer 
la relation entre l'entrée et la sortie.

\begin{align*}
    S\big(1\mp H_1H_2\big)&=H_1E 
\end{align*}

On obtient alors la formule de Black\footnote{
\index{Black, Harold}Harold Stephen Black (1898-1983) ingénieur, 
électronicien américain.}, 
reliant la sortie est l'entrée d'une boucle de contre-réaction :
\begin{bequation}[ams align]
    S&=\dfrac{H_1}{1\mp H_1H_2}E
\end{bequation}

Notons l'inversion du signe du dénominateur de la formule 
selon que la boucle est positive ou négative.

La boucle de contre-réaction est donc équivalente au schéma-bloc 
simplifié suivant :
\begin{center}
    \tikzsetnextfilename{boucle_eq-chap_bloc-ext}
    \input{tikz/boucle_eq-chap_bloc.tex}
\end{center}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Boucle de contre-réaction unitaire}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Une boucle de contre-réaction unitaire est une boucle de contre-réaction sans 
fonction de transfert de retour (ex: dans le cas présenté précedemment $H_2=1$).

\begin{center}
    \tikzsetnextfilename{boucle_uni-chap_bloc-ext}
    \input{tikz/boucle_uni-chap_bloc.tex}
\end{center}

La formule de Black se simplifie alors de la façon suivante :
\begin{bequation}[ams align]
    S&=\dfrac{H_1}{1+H_1}E
\end{bequation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Manipulation de schéma-bloc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Nous allons ici présenter différentes manipulations que nous
pourront appliquer au schéma-bloc. Ces manipulations peuvent
être vues comme des opérations d'une \textbf{algèbre de blocs}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Déplacement d'un comparateur vers la gauche}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Considérons le schéma-bloc suivant :
\begin{center}
    \tikzsetnextfilename{dep_comp1-chap_bloc-ext}
    \input{tikz/dep_comp1-chap_bloc.tex}
\end{center}

Pour pouvoir déplacer le comparateur vers la gauche, 
il faut introduire le bloc $K$ dans la chaine direct.
En conséquence, la chaîne de retour doit être modifiée pour ne pas affecter 
la sortie globale $S$. Le schéma fonctionnel précédent est donc équivalent 
au schéma ci-dessous :

\begin{center}
    \tikzsetnextfilename{dep_comp2-chap_bloc-ext}
    \input{tikz/dep_comp2-chap_bloc.tex}
\end{center}


Dans le cas particulier où les deux branches du comparateur sont toutes 
les deux affectées par la même fonction de transfert, il suffit de déplacer 
la fonction de transfert après le comparateur. Par exemple, les deux 
schémas-blocs suivants sont équivalents: 

\begin{center}
    \tikzsetnextfilename{dep_comp3-chap_bloc-ext}
    \input{tikz/dep_comp3-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Déplacement d'un point de prélèvement vers la droite}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Considérons le schéma-bloc suivant :
\begin{center}
    \tikzsetnextfilename{dep_jonc1-chap_bloc-ext}
    \input{tikz/dep_jonc1-chap_bloc.tex}
\end{center}
Il est aisé de déplacer le bloc $K$ devant le point de prélèvement:  
\begin{center}
    \tikzsetnextfilename{dep_jonc2-chap_bloc-ext}
    \input{tikz/dep_jonc2-chap_bloc.tex}
\end{center}

Dans le cas particulier où seul une branche est affectée par le bloc, 
il faut réduire la branche non affectée après avoir déplacer le point 
de prélèvement. Ansi les deux schémas-blocs ci-dessous sont équivalents:

\begin{center}
    \tikzsetnextfilename{dep_jonc3-chap_bloc-ext}
    \input{tikz/dep_jonc3-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Cas d'entrées multiples\label{sec-bloc_multE}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Dans le cas d'un système possédant plusieurs entrées, il est possible 
de simplifier le problème en appliqant le principe de superposition. La réponse 
totale devient alors la somme des réponses individuelles de chaque entrée 
lorsque toutes les autres sont considérées comme nulles.

Considérons le schéma-blocs suivant :
\begin{center}
    \tikzsetnextfilename{reduc_mult1-chap_bloc-ext}
    \input{tikz/reduc_mult1-chap_bloc.tex}
\end{center}

Dans un premier temps, on considère l'entrée $P$ nulle, le schéma-bloc devient :
\begin{center}
    \tikzsetnextfilename{reduc_mult2-chap_bloc-ext}
    \input{tikz/reduc_mult2-chap_bloc.tex}
\end{center}
La sortie $S_{P\equiv 0}$ (i.e lorsque $P\equiv0$) est donc donnée 
par la formule de Black pour la boucle de contre-réaction ainsi obtenue.
$$
S_{P\equiv 0}=\dfrac{H_1H_2}{1+R_1H_1H_2} E
$$

Dans le cas où l'on considère maintenant l'entrée $E$ comme nulle,
le schéma-bloc se réduit de la façon suivante :
\begin{center}
    \tikzsetnextfilename{reduc_mult3-chap_bloc-ext}
    \input{tikz/reduc_mult3-chap_bloc.tex}
\end{center}

La sortie $S_{E\equiv 0}$ est donc donnée par,
$$
S_{E\equiv 0}=\dfrac{H_2}{1+R_1H_1H_2} P
$$

La sortie totale $S$ du système à deux entrées est la somme de ses
sorties indépendantes,
\begin{bequation}[ams align]
    S&=S_{P\equiv 0}+S_{E\equiv 0} \\
    S&=\dfrac{H_1H_2}{1+R_1H_1H_2} E + \dfrac{H_2}{1+R_1H_1H_2} P \\ 
    S&=H_E E + H_P P 
\end{bequation}

Si $E$ est une entrée de consigne et $P$ une perturbation, $H_E$ et $H_P$ 
sont respectivement appelées \textbf{fonction de transfert d'asservissement} 
et \textbf{fonction de transfert de régulation}.
Remarquons que le dénominateur de ces fonctions de transferts sont identiques.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section[Réduction de schéma-bloc de grande taille]
{Méthodologie générale pour la réduction de schéma-bloc de grande taille}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Nous venons de présenter les principales transformations et manipulations qui 
peuvent être appliquées aux schémas fonctionnels. Nous donnons ici une 
approche simple pour la réduction de schéma-bloc de grande 
taille \cite{Ostertag}:
\begin{enumerate}
    \item Regrouper les blocs en parallèle et en série.
    \item \'Eliminer les boucles de contre-réaction locales.
    \item Déplacer les sommateurs/comparateurs vers la gauche et déplacer les 
          jonctions vers la droite.
    \item Répéter pour obtenir une forme canonique pour une entrée particulière.
    \item Dans le cas d'entrée multiple, répéter (1-4) pour chaque entrée. 
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Exemple à entrée simple}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Nous allons appliquer étape par étape cette méthodologie à la réduction du 
schéma-bloc, à une seule entrée, suivant :

\begin{center}
    \tikzsetnextfilename{exemple_1-chap_bloc-ext}
    \input{tikz/exemple_1-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{\'Etape 1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Regroupons d'abord les blocs en cascades :

\begin{center}
    \tikzsetnextfilename{exemple_2-chap_bloc-ext}
    \input{tikz/exemple_2-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{\'Etape 2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Déplaçons le point de prélèvement de la boucle de retour inférieur vers 
la droite  : 

\begin{center}
    \tikzsetnextfilename{exemple_3-chap_bloc-ext}
    \input{tikz/exemple_3-chap_bloc.tex}
\end{center}
L'étape précédente nous permet d'identifier une boucle de contre-réaction 
locale ($B_1$). Après réduction de cette boucle, le schéma-blocs dévient : 

\begin{center}
    \tikzsetnextfilename{exemple_4-chap_bloc-ext}
    \input{tikz/exemple_4-chap_bloc.tex}
\end{center}

\`A nouveau il est possible d'identifier une boucle de contre-réaction $B_2$ :

\begin{center}
    \tikzsetnextfilename{exemple_5-chap_bloc-ext}
    \input{tikz/exemple_5-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{\'Etape 3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Enfin, il nous suffit de réduire la boucle de contre-réaction $B_2$ par la 
formule de Black:

\begin{center}
    \tikzsetnextfilename{exemple_6-chap_bloc-ext}
    \input{tikz/exemple_6-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Exemple à entrées multiples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

On considère le schéma fonctionnel suivant qui est exactement celui traité
précédemment mais en ayant incorporer une nouvelle entrée $P$.

\begin{center}
    \tikzsetnextfilename{exemple_7-chap_bloc-ext}
    \input{tikz/exemple_7-chap_bloc.tex}
\end{center}

La première étape consiste à déterminer la fonction de transfert globale entre
la sortie $S$ et $E$ pour $P\equiv0$.
Celle-ci correspond à la fonction de transfert déterminée précédemment, soit :
$$
     S_{P\equiv0}=\dfrac{H_1H_2H_3H_4}{1+R_1H_3H_4+R_2R_3H_1H_2H_3}E
$$

Le schéma fonctionnel réduit pour $E\equiv0$ est maintenant :

\begin{center}
    \tikzsetnextfilename{exemple_8-chap_bloc-ext}
    \input{tikz/exemple_8-chap_bloc.tex}
\end{center}

Déplaçons le point de jonction situé entre les blocs $H_3$ et $H_4$ 
vers la droite et réduisons les blocs en série :

\begin{center}
    \tikzsetnextfilename{exemple_9-chap_bloc-ext}
    \input{tikz/exemple_9-chap_bloc.tex}
\end{center}

La réduction de la boucle de contre réaction interne nous donne :

\begin{center}
    \tikzsetnextfilename{exemple_10-chap_bloc-ext}
    \input{tikz/exemple_10-chap_bloc.tex}
\end{center}

La réduction de cette dernière boucle de contre réaction nous donne alors
la fonction de transfert globale pour $E\equiv0$. 
En utilisant le principe de superposition, on montre alors que la fonction 
de transfert globale pour les deux entrées est:
\begin{align*}
    S&=S_{P\equiv 0}+S_{E\equiv 0} \\
    S&=\dfrac{H_1H_2H_3H_4}{1+R_1H_3H_4+R_2R_3H_1H_2H_3} E + 
       \dfrac{H_2H_3H_4}{1+R_1H_3H_4+R_2R_3H_1H_2H_3} P 
\end{align*}


%\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Graphe de fluence}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Nous discutons ici d'une approche sensiblement différente 
pour la représentation graphique des relations mathématiques 
intervenants dans les \gls{slci}. Cette partie est largement
inspirée de~\cite{Ostertag}. Elle peut être omise au cours 
d'une première lecture. L'algèbre de ces graphes de fluence
est cependant très éfficace et trouve de nombreuses applications 
en dehors de l'automatique. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Définitions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Branche et noeud}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Dans l'application qui nous intéresse, un graphe de fluence 
peut être vu comme un schéma fonctionnel allégé. En effet, le graphe de fluence 
ne comporte que deux éléments de base: le \textbf{noeud} et la 
\textbf{branche orientée}. Les noeuds portent les variables du système 
(entrée, sortie, perturbation, commande\ldots). 
Une branche reliant deux noeuds peut être ornée du facteur multiplicatif ou 
de la fonction de transfert.

L'\cref{eq-ES} reliant une entrée et sortie par l'intermédiaire d'une fonction 
de transfert se représente par le graphe de fluence suivant:

\begin{center}
    \tikzsetnextfilename{gf_1-chap_bloc-ext}
    \input{tikz/gf_1-chap_bloc.tex}
$$
S=HE
$$
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Source, puits et parcours}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Nous allons condidérer le graphe de fluence suivant, pour illustrer 
différentes définitions: 

\begin{figure}[!h]
\begin{center}
    \tikzsetnextfilename{gf_source-chap_bloc-ext}
    \input{tikz/gf_source-chap_bloc.tex}
\end{center}
    \caption{Graphe de fluence présentant les différents éléments de bases, 
    types de noeuds et de branches.}
\end{figure}

\begin{itemize}
    \item Une \textbf{source} ou noeud d'entrée est un noeud 
          dont toutes les branches sont divergentes. Exemple: le noeud 
          $E$ est une source.
    \item Un \textbf{puits} ou noeud de sortie est un noeud dont toutes 
    les branches sont convergentes. Exemple: le noeud $S$ est un puits.
    \item Un \textbf{parcours} est une succession continue, 
    unidirectionnelle de branches. Exemples: 
    $\{E\rightarrow X_1\rightarrow X_2\rightarrow S\}$, 
    $\{E\rightarrow X_1\rightarrow S\}$, 
    $\{X_1\rightarrow X_2\rightarrow S\}$, 
    $\{E\rightarrow X_1\rightarrow X_2\rightarrow X_1\rightarrow S\}$

    \item Un \textbf{parcours ouvert} est un parcours le long duquel chaque 
          noeud n'est franchi qu'une fois. Exemples: 
          $\{E\rightarrow X_1\rightarrow X_2\rightarrow S\}$, 
          $\{E\rightarrow X_1 \rightarrow S\}$
    \item Un \textbf{parcours fermé} ou \textbf{boucle} est un parcours qui 
          aboutit au noeud dont il est parti, chaque autre noeud n'étant 
          franchi qu'une seule fois. Exemples: 
          $\{X_1\rightarrow X_2\rightarrow X_1\}$, 
          $\{X_2\rightarrow X_2\}$ (cette dernière est appelée boucle 
          élémentaire)
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Algèbre des graphes de fluences}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Nous présentons ici 7 opérations de bases liées à l'algèbre des 
graphes de fluence.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{1. Addition en un noeud}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

La valeur d'un noeud est égale à la somme de tous les signaux convergeant 
vers ce noeud.
\begin{center}
    \tikzsetnextfilename{gf_add-chap_bloc-ext}
    \input{tikz/gf_add-chap_bloc.tex}
\end{center}
$$
S=H_1E_1+H_2E_2
$$

Le comparateur/sommateur présentait précedemment est équivalent au graphe 
de fluence suivant:

\begin{center}
    \tikzsetnextfilename{sb_gf-chap_bloc-ext}
    \input{tikz/sb_gf-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{2. Distribution par un noeud}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

La valeur d'un noeud est transmise par chaque branche quittant ce noeud.
\begin{center}
    \tikzsetnextfilename{gf_distrib-chap_bloc-ext}
    \input{tikz/gf_distrib-chap_bloc.tex}
\end{center}

Ce graphe représente les équations suivantes :
\begin{align*}
    X_1&=H_1E_1+H_2E_2\\
    S_1&=H_3X_1=H_1H_3E_1+H_2H_3E_2\\
    S_2&=H_4X_1=H_1H_4E_1+H_2H_4E_2
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{3. Branches en série}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Un suite de branches en série peut étre réduite à une unique branche, dont la 
fonction de transfert est égale au produit des fonctions de transfert des 
diverses branches.

\begin{center}
    \tikzsetnextfilename{gf_branche_serie-chap_bloc-ext}
    \input{tikz/gf_branche_serie-chap_bloc.tex}
\end{center}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{4. Branche en parallèle}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Deux ou plusieurs branches connectées en parallèle, reliant le même noeud 
d'origine au même noeud extrémité, peuvent être réduites par une branche 
unique, dont la fonction de transfert est égale à la somme des fonctions de 
transfert des diverses branches. 

\begin{center}
    \tikzsetnextfilename{gf_branche_para-chap_bloc-ext}
    \input{tikz/gf_branche_para-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{5. Absorption d'un noeud}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Un noeud qui n'est ni une source ni un puits peut être supprimé de la
manière suivante :

\begin{center}
    \tikzsetnextfilename{gf_absorption-chap_bloc-ext}
    \input{tikz/gf_absorption-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{6. Boucles de contre-réaction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Considérons la boucle de contre-réaction définit par le schéma fonctionnel et 
le graphe de fluence équivalent:
\begin{center}
    \tikzsetnextfilename{gf_boucle1-chap_bloc-ext}
    \input{tikz/gf_boucle1-chap_bloc.tex}
\end{center}

La variable $M$ du graphe de fluence peut être réduit, ce qui donne :

\begin{center}
    \tikzsetnextfilename{gf_boucle2-chap_bloc-ext}
    \input{tikz/gf_boucle2-chap_bloc.tex}
\end{center}

Il est possible d'éliminer le noeud porté par la variable $\epsilon$:

\begin{center}
    \tikzsetnextfilename{gf_boucle3-chap_bloc-ext}
    \input{tikz/gf_boucle3-chap_bloc.tex}
\end{center}
Ce dernier graphe exprime la relation suivante :
$$
S=H_1E-H_1H_2S
$$
d'où l'expression déjà établie :
$$
    S=\dfrac{H_1}{1+H_1H_2}E,
$$

qui se représente simplement par le graphe de fluence :
\begin{center}
    \tikzsetnextfilename{gf_boucle4-chap_bloc-ext}
    \input{tikz/gf_boucle4-chap_bloc.tex}
\end{center}
Comme nous l'avons déjà discuté, dans le cas d'une boucle 
de contre-réaction unitaire, la branche de retour est égale à 1
\begin{center}
    \tikzsetnextfilename{gf_boucle5-chap_bloc-ext}
    \input{tikz/gf_boucle5-chap_bloc.tex}
\end{center}
De la même manière que précedemment, le graphe de fluence se limite à 
deux noeud et deux branches (dont une boucle élémentaire).
\begin{center}
    \tikzsetnextfilename{gf_boucle6-chap_bloc-ext}
    \input{tikz/gf_boucle6-chap_bloc.tex}
\end{center}
La fonction de transfert est simplement représentée par le graphe 
suivant\footnote{Remarquons que le graphe précédent exprime la relation 
$S=H(E-S)$ qui nous donne bien la fonction de transfert $\frac{H}{1+H}$. 
Cependant, cette expression exprime une grandeur que l'on cherche en fonction 
d'elle même. En remplaçant, $S$ par sa définition $H(E-S)$, on obtient
$$S=HE-H(H(E-S))=HE-H^2E+H^2S=H(1-H)E+H^2S.$$ En procédant de même avec 
cette nouvelle expression, on obtient une relation de récurrence. 
\begin{align*}
    S=EH\sum_k^n (-1)^kH^k+(-1)^{(n+1)}H^{n+1}S
\end{align*}
Pour $n\rightarrow\infty$, on reconnaît la série géométrique 
$\sum_k^n(-1)^kH^k=\frac{1}{1+H}$ et $H^{n+1}\rightarrow 0$ pour $|H|<1$.
La sortie $S$ tend donc bien vers la fonction de transfert attendue, 
seulement si $|H|<1$. Cette dernière condition pourra être interprétée 
comme une limite de stabilité du gain de la fonction de transfert dans 
le cas d'un système dans une boucle de contre réaction.}
\begin{center}
    \tikzsetnextfilename{gf_boucle7-chap_bloc-ext}
    \input{tikz/gf_boucle7-chap_bloc.tex}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{7. Le gain d'un parcours}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Le gain d'un parcours est le produit des toutes 
les fonctions de tranfert des branches parcourues. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Règle de Mason}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Ces opérations de bases vont nous permettre d'introduire la 
règle de Mason\footnote{\index{Mason, Samuel}Samuel Jefferson 
Mason (1921-1974), électronicien américain.}. Cette régle permet de réduire 
le graphe de fluence et déterminer la fonction de transfert entre l'entrée 
et la sortie d'un graphe de fluence.

La fonction de transfert globale $H$ entre la source $E$ et le puits $S$ d'un 
graphe de fluence est égale à 
\begin{bequation}[ams align]
H=\dfrac{S}{E}=\dfrac{1}{\Delta}\sum_k G_k\Delta_k
\end{bequation}
où
\begin{itemize}
    \item $k$ dénombre les parcours ouverts entre $E$ et $S$,
    \item $G_k$ est le gain du $k$-ème parcours ouverts
    \item $\Delta$ est le \textbf{déterminant du graphe}, donné par :
        \begin{bequation}[ams align]
        \Delta=1-\sum_i B_i-\sum_{i,j} B_iB_j - \sum_{i,j,k} B_iB_jB_k\ldots 
        \end{bequation}
        où les $B_i$ sont les gains des boucles du graphe de fluence, d'abord 
        pris séparemment ($\sum_i B_i$) puis deux à deux 
        ($\sum_{i,j} B_iB_j$), puis par trois $(\sum_{i,j,k} B_iB_jB_k)$ et 
        ainsi de suite. On ne prend en compte que les produits de boucles 
        disjoints, c'est à dire n'ayant aucun noeud en commun.
    \item $\Delta_i$ est le déterminant du graphe obtenu en supprimant le 
        parcours ouvert de gain $G_i$.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Exemple 1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
    \tikzsetnextfilename{gf_mason1-chap_bloc-ext}
    \input{tikz/gf_mason1-chap_bloc.tex}
\end{center}
Ce graphe de fluence possède trois boucles de gain :
\begin{itemize}
    \item $-H_1H_2H_3$
    \item $R_1H_1H_2$
    \item $-R_2H_2H_3$ 
\end{itemize}
et un parcours ouvert $H_1H_2H_3$ de déterminant $\Delta_k=1$. Les boucles 
étant toutes disjointes, le determinant du graphe est donc simplement 
donné par :
$$
\Delta=1-R_1H_1H_2+H_1H_2H_3+R_2H_2H_3
$$
La fonction de transfert de ce graphe de fluence est donc :
$$
H=\dfrac{H_1H_2H_3}{1-R_1H_1H_2+H_1H_2H_3+R_2H_2H_3}
$$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Exemple 2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
    \tikzsetnextfilename{gf_mason2-chap_bloc-ext}
    \input{tikz/gf_mason2-chap_bloc.tex}
\end{center}
Ce graphe de fluence présente 2 boucles non disjointes de gain $R_3$ 
et $R_2H_3H_4$ et 2 parcours ouverts de gain $H_1H_2H_3H_4$ et $R_1H_1H_4$.
Le déterminant du graphe est donc donné par 
$$
\Delta=1-R_3-R_2H_3H_4
$$
La fonction de transfert associé à ce graphe de fluence est donc:
$$
H=\dfrac{H_1H_2H_3H_4+R_1H_1H_4}{1-R_3-R_2H_3H_4}
$$


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Schéma-bloc dans le domaine temporel}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section*{Exercices du chapitre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section*{Corrigé des exercices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%chap_bloc.tex
